<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wait a second ....</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, darkred 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            color: white;
        }
        .loading-container {
            text-align: center;
            background: rgba(255,255,255,0.1);
            padding: 40px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        .spinner {
            border: 4px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top: 4px solid white;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .language-list {
            margin-top: 20px;
            font-size: 14px;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="loading-container">
        <div class="spinner"></div>
        <h2>Detecting your language...</h2>
        <p>Please wait a moment</p>
        <div class="language-list">
            Supported: EN, FA, AR, DE, ES, FR, HI, JA, KO, RU, TR, ZH
        </div>
    </div>

    <script>
        // Ø¢Ø¯Ø±Ø³ Ù¾Ø§ÛŒÙ‡ Ù¾Ø±ÙˆÚ˜Ù‡
        const BASE_URL = 'https://s786mc.github.io/uuid-gen/';

        // Ù„ÛŒØ³Øª Ú©Ø§Ù…Ù„ Ø²Ø¨Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯
        const availableLanguages = {
            'ar': 'lang-ar.html',
            'de': 'lang-de.html', 
            'en': 'lang-en.html',
            'es': 'lang-es.html',
            'fa': 'lang-fa.html',
            'fr': 'lang-fr.html',
            'hi': 'lang-hi.html',
            'ja': 'lang-ja.html',
            'ko': 'lang-ko.html',
            'ru': 'lang-ru.html',
            'tr': 'lang-tr.html',
            'zh': 'lang-zh.html'
        };

        // Ø¬Ø¯ÙˆÙ„ Ù…Ù¾ÛŒÙ†Ú¯ Ø²Ø¨Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ù…Ø±ÙˆØ±Ú¯Ø± Ø¨Ù‡ Ú©Ø¯Ù‡Ø§ÛŒ Ù…Ø§
        const languageMapping = {
            // ÙØ§Ø±Ø³ÛŒ Ùˆ Ø¹Ø±Ø¨ÛŒ
            'fa': 'fa', 'fa-ir': 'fa', 'persian': 'fa',
            'ar': 'ar', 'ar-sa': 'ar', 'arabic': 'ar',
            
            // Ø§Ø±ÙˆÙ¾Ø§ÛŒÛŒ
            'en': 'en', 'en-us': 'en', 'en-gb': 'en', 'english': 'en',
            'de': 'de', 'de-de': 'de', 'german': 'de',
            'es': 'es', 'es-es': 'es', 'spanish': 'es', 
            'fr': 'fr', 'fr-fr': 'fr', 'french': 'fr',
            'it': 'en', // Ø§ÛŒØªØ§Ù„ÛŒØ§ÛŒÛŒ Ø¨Ù‡ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ (fallback)
            
            // Ø¢Ø³ÛŒØ§ÛŒÛŒ
            'hi': 'hi', 'hi-in': 'hi', 'hindi': 'hi',
            'ja': 'ja', 'ja-jp': 'ja', 'japanese': 'ja',
            'ko': 'ko', 'ko-kr': 'ko', 'korean': 'ko',
            'zh': 'zh', 'zh-cn': 'zh', 'zh-tw': 'zh', 'chinese': 'zh',
            'ru': 'ru', 'ru-ru': 'ru', 'russian': 'ru',
            'tr': 'tr', 'tr-tr': 'tr', 'turkish': 'tr'
        };

        // ØªØ§Ø¨Ø¹ Ù‡ÙˆØ´Ù…Ù†Ø¯ ØªØ´Ø®ÛŒØµ Ø²Ø¨Ø§Ù†
        function detectUserLanguage() {
            console.log('ðŸ” Starting language detection...');

            // 1. Ø§ÙˆÙ„ÙˆÛŒØª: Ù¾Ø§Ø±Ø§Ù…ØªØ± URL (Ù…Ø«Ù„ ?lang=fa)
            const urlParams = new URLSearchParams(window.location.search);
            const urlLang = urlParams.get('lang');
            if (urlLang && availableLanguages[urlLang]) {
                console.log('âœ… Language from URL:', urlLang);
                return urlLang;
            }

            // 2. Ø§ÙˆÙ„ÙˆÛŒØª: Ø²Ø¨Ø§Ù† Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡
            const savedLang = localStorage.getItem('user-language');
            if (savedLang && availableLanguages[savedLang]) {
                console.log('âœ… Language from storage:', savedLang);
                return savedLang;
            }

            // 3. Ø§ÙˆÙ„ÙˆÛŒØª: Ø²Ø¨Ø§Ù† Ù…Ø±ÙˆØ±Ú¯Ø±
            const browserLanguages = navigator.languages || [navigator.language || navigator.userLanguage || 'en'];
            console.log('ðŸŒ Browser languages:', browserLanguages);

            for (let lang of browserLanguages) {
                // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù…Ù†Ø·Ù‚Ù‡ (Ù…Ø«Ù„Ø§Ù‹ en-US -> en)
                const cleanLang = lang.split('-')[0].toLowerCase();
                
                // Ú†Ú© Ú©Ø±Ø¯Ù† Ù…Ø³ØªÙ‚ÛŒÙ…
                if (availableLanguages[cleanLang]) {
                    console.log('âœ… Direct match found:', cleanLang);
                    return cleanLang;
                }
                
                // Ú†Ú© Ú©Ø±Ø¯Ù† Ø§Ø² Ø·Ø±ÛŒÙ‚ Ù…Ù¾ÛŒÙ†Ú¯
                if (languageMapping[lang.toLowerCase()]) {
                    const mappedLang = languageMapping[lang.toLowerCase()];
                    console.log('âœ… Mapped language:', lang, '->', mappedLang);
                    return mappedLang;
                }
                
                // Ú†Ú© Ú©Ø±Ø¯Ù† clean version Ø¯Ø± Ù…Ù¾ÛŒÙ†Ú¯
                if (languageMapping[cleanLang]) {
                    const mappedLang = languageMapping[cleanLang];
                    console.log('âœ… Clean mapped language:', cleanLang, '->', mappedLang);
                    return mappedLang;
                }
            }

            // 4. ØªØ´Ø®ÛŒØµ Ø§Ø² Ø·Ø±ÛŒÙ‚ Ù…ÙˆÙ‚Ø¹ÛŒØª
            const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            console.log('ðŸ“ Timezone:', timezone);
            
            if (timezone.includes('Tehran') || timezone.includes('Iran')) {
                return 'fa';
            }
            if (timezone.includes('Turkey') || timezone.includes('Istanbul')) {
                return 'tr';
            }
            if (timezone.includes('Arab') || timezone.includes('Dubai')) {
                return 'ar';
            }
            if (timezone.includes('Russia') || timezone.includes('Moscow')) {
                return 'ru';
            }

            // 5. Ù¾ÛŒØ´â€ŒÙØ±Ø¶
            console.log('ðŸŒ Default language: en');
            return 'en';
        }

        // ØªØ§Ø¨Ø¹ Ù‡Ø¯Ø§ÛŒØª Ù‡ÙˆØ´Ù…Ù†Ø¯
        function smartRedirect() {
            const userLang = detectUserLanguage();
            const targetPage = availableLanguages[userLang];
            
            if (!targetPage) {
                console.error('âŒ Target page not found for language:', userLang);
                // Fallback Ø¨Ù‡ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ
                window.location.href = BASE_URL + 'lang-en.html';
                return;
            }
            
            const fullURL = BASE_URL + targetPage;
            console.log('ðŸŽ¯ Redirecting to:', fullURL);
            
            // Ø°Ø®ÛŒØ±Ù‡ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±
            localStorage.setItem('user-language', userLang);
            
            // Ù‡Ø¯Ø§ÛŒØª Ø¨Ø§ ØªØ§Ø®ÛŒØ± Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø§Ù†ÛŒÙ…ÛŒØ´Ù†
            setTimeout(() => {
                window.location.href = fullURL;
            }, 1500);
        }

        // Ø§Ø¬Ø±Ø§ ÙˆÙ‚ØªÛŒ ØµÙØ­Ù‡ Ù„ÙˆØ¯ Ø´Ø¯
        document.addEventListener('DOMContentLoaded', smartRedirect);

        // Ù‡Ù…Ú†Ù†ÛŒÙ† Ø§Ú¯Ø± JavaScript ØºÛŒØ±ÙØ¹Ø§Ù„ Ø¨ÙˆØ¯
        setTimeout(() => {
            if (!window.location.href.includes('.html')) {
                window.location.href = BASE_URL + 'lang-en.html';
            }
        }, 3000);
    </script>
</body>
          </html>
